knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
getwd()
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
getwd()
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
fb2018_JY_282_4plots <- read_csv("data/fb2018_JY_282_4plots.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
fb18 <- read_csv("data/fb2018_JY_282_4plots.csv")
fb18 <- read_csv("NUE_Project_data/fb2018_JY_282_4plots.csv")
library(readr)
fb2018_JY_282_4plots <- read_csv("data/fb2018_JY_282_4plots.csv")
View(fb2018_JY_282_4plots)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
getwd()
#knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
getwd()
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
fb18 <- read.csv("../data/fb2018_JY_282_4plots.csv")
#View(fb18)
fb18$block <- "B1"
fb18[fb18$row > 3000,]$block <- "B2"
fb18$nitrogen <- "+N"
fb18[fb18$row > 2000 & fb18$row < 4000, ]$nitrogen <- "-N"
fb18$sb <- NA
fb18$reminder1 <- fb18$row %% 1000
fb18$reminder2 <- fb18$reminder1 %% 100
fb18[fb18$reminder1 < 300 & fb18$reminder2 <= 48,]$sb <- "sb1"
fb18[fb18$reminder1 < 300 & fb18$reminder2 > 48,]$sb <- "sb2"
fb18[fb18$reminder1 > 300 & fb18$reminder2 <= 48,]$sb <- "sb3"
fb18[fb18$reminder1 > 300 & fb18$reminder2 > 48,]$sb <- "sb4"
table(fb18$sb)
fb18$spb <- NA
fb18[fb18$sb == "sb1" & fb18$reminder2 <= 16,]$spb <- "spb1"
fb18[fb18$sb == "sb1" & fb18$reminder2 > 16 & fb18$reminder2 <= 32,]$spb <- "spb2"
fb18[fb18$sb == "sb1" & fb18$reminder2 > 32 & fb18$reminder2 <= 48,]$spb <- "spb3"
fb18[fb18$sb == "sb2" & fb18$reminder2 > 48 & fb18$reminder2 <= 64,]$spb <- "spb1"
fb18[fb18$sb == "sb2" & fb18$reminder2 > 64 & fb18$reminder2 <= 80,]$spb <- "spb2"
fb18[fb18$sb == "sb2" & fb18$reminder2 > 80 & fb18$reminder2 <= 96,]$spb <- "spb3"
fb18[fb18$sb == "sb3" & fb18$reminder2 <= 16,]$spb <- "spb1"
fb18[fb18$sb == "sb3" & fb18$reminder2 > 16 & fb18$reminder2 <= 32,]$spb <- "spb2"
fb18[fb18$sb == "sb3" & fb18$reminder2 > 32 & fb18$reminder2 <= 48,]$spb <- "spb3"
fb18[fb18$sb == "sb4" & fb18$reminder2 > 48 & fb18$reminder2 <= 64,]$spb <- "spb1"
fb18[fb18$sb == "sb4" & fb18$reminder2 > 64 & fb18$reminder2 <= 80,]$spb <- "spb2"
fb18[fb18$sb == "sb4" & fb18$reminder2 > 80 & fb18$reminder2 <= 96,]$spb <- "spb3"
table(fb18$spb)
table(subset(fb18, sb=="sb4")$spb)
fb18$Rep <- "1"
fb18[fb18$row > 3000,]$Rep <- "2"
write.table(fb18[, -16:-17], "cache/fb2018_meta.csv", sep=",", row.names = FALSE, quote=FALSE)
fb18$spb <- NA
fb18[fb18$sb == "sb1" & fb18$reminder2 <= 16,]$spb <- "spb1"
fb18[fb18$sb == "sb1" & fb18$reminder2 > 16 & fb18$reminder2 <= 32,]$spb <- "spb2"
fb18[fb18$sb == "sb1" & fb18$reminder2 > 32 & fb18$reminder2 <= 48,]$spb <- "spb3"
fb18[fb18$sb == "sb2" & fb18$reminder2 > 48 & fb18$reminder2 <= 64,]$spb <- "spb1"
fb18[fb18$sb == "sb2" & fb18$reminder2 > 64 & fb18$reminder2 <= 80,]$spb <- "spb2"
fb18[fb18$sb == "sb2" & fb18$reminder2 > 80 & fb18$reminder2 <= 96,]$spb <- "spb3"
fb18[fb18$sb == "sb3" & fb18$reminder2 <= 16,]$spb <- "spb1"
fb18[fb18$sb == "sb3" & fb18$reminder2 > 16 & fb18$reminder2 <= 32,]$spb <- "spb2"
fb18[fb18$sb == "sb3" & fb18$reminder2 > 32 & fb18$reminder2 <= 48,]$spb <- "spb3"
fb18[fb18$sb == "sb4" & fb18$reminder2 > 48 & fb18$reminder2 <= 64,]$spb <- "spb1"
fb18[fb18$sb == "sb4" & fb18$reminder2 > 64 & fb18$reminder2 <= 80,]$spb <- "spb2"
fb18[fb18$sb == "sb4" & fb18$reminder2 > 80 & fb18$reminder2 <= 96,]$spb <- "spb3"
table(fb18$spb)
table(subset(fb18, sb=="sb4")$spb)
fb18$Rep <- "1"
fb18[fb18$row > 3000,]$Rep <- "2"
write.table(fb18[, -16:-17], "../cache/fb2018_meta.csv", sep=",", row.names = FALSE, quote=FALSE)
write.table(fb18[, -16:-17], "cache/fb2018_meta.csv", sep=",", row.names = FALSE, quote=FALSE)
write.table(fb18[, -16:-17], "../cache/fb2018_meta.csv", sep=",", row.names = FALSE, quote=FALSE)
fb18_meta <- read.csv("../cache/fb2018_meta.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('/../'))
#library(tidyverse)
fb18 <- read.csv("data/fb2018_JY_282_4plots.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb <- read.csv("data/fb2019_JY_282_4plots_havelock_final.csv")
fb <- read.csv("../data/fb2019_JY_282_4plots_havelock_final.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb <- read.csv("../data/fb2019_JY_282_4plots_havelock_final.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb <- read.csv("../data/fb2019_JY_282_4plots_havelock_final.csv")
library(readr)
fb2019_JY_282_4plots_havelock_final <- read_csv("data/fb2019_JY_282_4plots_havelock_final.csv")
fb2019_JY_282_4plots_havelock_final <- read_csv("../data/fb2019_JY_282_4plots_havelock_final.csv")
getwd()
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb <- read.csv("../data/fb2019_JY_282_4plots_havelock_final.csv")
fb <- read.csv("data/fb2019_JY_282_4plots_havelock_final.csv")
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb <- read.csv("data/fb2019_JY_282_4plots_havelock_final.csv")
fb <- read.csv("../data/fb2019_JY_282_4plots_havelock_final.csv")
fb$block <- "B1"
fb[fb$row > 3000,]$block <- "B2"
fb$nitrogen <- "+N"
fb[fb$row > 2000 & fb$row < 4000, ]$nitrogen <- "-N"
fb$sb <- NA
fb$reminder1 <- fb$row %% 1000
fb$reminder2 <- fb$reminder1 %% 100
fb[fb$reminder1 < 300 & fb$reminder2 <= 42,]$sb <- "sb1"
fb[fb$reminder1 < 300 & fb$reminder2 > 42,]$sb <- "sb2"
fb[fb$reminder1 > 300 & fb$reminder2 <= 42,]$sb <- "sb3"
fb[fb$reminder1 > 300 & fb$reminder2 > 42,]$sb <- "sb4"
table(fb$sb)
fb$spb <- NA
fb[fb$sb == "sb1" & fb$reminder2 <= 14,]$spb <- "spb1"
fb[fb$sb == "sb1" & fb$reminder2 > 14 & fb$reminder2 <= 28,]$spb <- "spb2"
fb[fb$sb == "sb1" & fb$reminder2 > 28 & fb$reminder2 <= 42,]$spb <- "spb3"
fb[fb$sb == "sb2" & fb$reminder2 > 42 & fb$reminder2 <= 56,]$spb <- "spb1"
fb[fb$sb == "sb2" & fb$reminder2 > 56 & fb$reminder2 <= 70,]$spb <- "spb2"
fb[fb$sb == "sb2" & fb$reminder2 > 70 & fb$reminder2 <= 84,]$spb <- "spb3"
fb[fb$sb == "sb3" & fb$reminder2 <= 14,]$spb <- "spb1"
fb[fb$sb == "sb3" & fb$reminder2 > 14 & fb$reminder2 <= 28,]$spb <- "spb2"
fb[fb$sb == "sb3" & fb$reminder2 > 28 & fb$reminder2 <= 42,]$spb <- "spb3"
fb[fb$sb == "sb4" & fb$reminder2 > 42 & fb$reminder2 <= 56,]$spb <- "spb1"
fb[fb$sb == "sb4" & fb$reminder2 > 56 & fb$reminder2 <= 70,]$spb <- "spb2"
fb[fb$sb == "sb4" & fb$reminder2 > 70 & fb$reminder2 <= 84,]$spb <- "spb3"
table(fb$spb)
table(subset(fb, sb=="sb4")$spb)
write.table(fb, "cache/fb2019_meta.csv", sep=",", row.names = FALSE, quote=FALSE)
write.table(fb, "../cache/fb2019_meta.csv", sep=",", row.names = FALSE, quote=FALSE)
fb$spb <- NA
fb[fb$sb == "sb1" & fb$reminder2 <= 14,]$spb <- "spb1"
fb[fb$sb == "sb1" & fb$reminder2 > 14 & fb$reminder2 <= 28,]$spb <- "spb2"
fb[fb$sb == "sb1" & fb$reminder2 > 28 & fb$reminder2 <= 42,]$spb <- "spb3"
fb[fb$sb == "sb2" & fb$reminder2 > 42 & fb$reminder2 <= 56,]$spb <- "spb1"
fb[fb$sb == "sb2" & fb$reminder2 > 56 & fb$reminder2 <= 70,]$spb <- "spb2"
fb[fb$sb == "sb2" & fb$reminder2 > 70 & fb$reminder2 <= 84,]$spb <- "spb3"
fb[fb$sb == "sb3" & fb$reminder2 <= 14,]$spb <- "spb1"
fb[fb$sb == "sb3" & fb$reminder2 > 14 & fb$reminder2 <= 28,]$spb <- "spb2"
fb[fb$sb == "sb3" & fb$reminder2 > 28 & fb$reminder2 <= 42,]$spb <- "spb3"
fb[fb$sb == "sb4" & fb$reminder2 > 42 & fb$reminder2 <= 56,]$spb <- "spb1"
fb[fb$sb == "sb4" & fb$reminder2 > 56 & fb$reminder2 <= 70,]$spb <- "spb2"
fb[fb$sb == "sb4" & fb$reminder2 > 70 & fb$reminder2 <= 84,]$spb <- "spb3"
table(fb$spb)
table(subset(fb, sb=="sb4")$spb)
write.table(fb, "../cache/fb2019_meta.csv", sep=",", row.names = FALSE, quote=FALSE)
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
#library(tidyverse)
fb <- read.csv("../data/fb2019_JY_282_4plots_havelock_final.csv")
fb$block <- "B1"
fb[fb$row > 3000,]$block <- "B2"
fb$nitrogen <- "+N"
fb[fb$row > 2000 & fb$row < 4000, ]$nitrogen <- "-N"
fb$sb <- NA
fb$reminder1 <- fb$row %% 1000
fb$reminder2 <- fb$reminder1 %% 100
fb[fb$reminder1 < 300 & fb$reminder2 <= 42,]$sb <- "sb1"
fb[fb$reminder1 < 300 & fb$reminder2 > 42,]$sb <- "sb2"
fb[fb$reminder1 > 300 & fb$reminder2 <= 42,]$sb <- "sb3"
fb[fb$reminder1 > 300 & fb$reminder2 > 42,]$sb <- "sb4"
table(fb$sb)
fb$spb <- NA
fb[fb$sb == "sb1" & fb$reminder2 <= 14,]$spb <- "spb1"
fb[fb$sb == "sb1" & fb$reminder2 > 14 & fb$reminder2 <= 28,]$spb <- "spb2"
fb[fb$sb == "sb1" & fb$reminder2 > 28 & fb$reminder2 <= 42,]$spb <- "spb3"
fb[fb$sb == "sb2" & fb$reminder2 > 42 & fb$reminder2 <= 56,]$spb <- "spb1"
fb[fb$sb == "sb2" & fb$reminder2 > 56 & fb$reminder2 <= 70,]$spb <- "spb2"
fb[fb$sb == "sb2" & fb$reminder2 > 70 & fb$reminder2 <= 84,]$spb <- "spb3"
fb[fb$sb == "sb3" & fb$reminder2 <= 14,]$spb <- "spb1"
fb[fb$sb == "sb3" & fb$reminder2 > 14 & fb$reminder2 <= 28,]$spb <- "spb2"
fb[fb$sb == "sb3" & fb$reminder2 > 28 & fb$reminder2 <= 42,]$spb <- "spb3"
fb[fb$sb == "sb4" & fb$reminder2 > 42 & fb$reminder2 <= 56,]$spb <- "spb1"
fb[fb$sb == "sb4" & fb$reminder2 > 56 & fb$reminder2 <= 70,]$spb <- "spb2"
fb[fb$sb == "sb4" & fb$reminder2 > 70 & fb$reminder2 <= 84,]$spb <- "spb3"
table(fb$spb)
table(subset(fb, sb=="sb4")$spb)
write.table(fb, "../cache/fb2019_meta.csv", sep=",", row.names = FALSE, quote=FALSE)
test1 <- subset(fb, block == "B2" & nitrogen =="-N" & sb=="sb4" & spb=="spb1")
sum(test1$genotype == "check")
fb <- read.csv("../cache/fb2019_meta.csv")
### file withplots replaced with checks:
ch <- read.csv("../data/CRRI_2019_Field_Book_Christine.csv")
fb2 <- merge(fb[, -4:-5], ch, by.x="row", by.y="Row")
write.table(fb2[, -13:-14], "../cache/fb2019_meta_replaced_check.csv", sep=",", row.names = FALSE, quote=FALSE)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=normalizePath('../../'))
#install.packages("readxl")
library(tidyverse)
#install.packages("readxl")
library(tidyverse)
library(readxl)
ph_2018 <- read.csv("data/phenotyping_2018_semra_all_traits.csv")
ph_2018 <- read.csv("../data/phenotyping_2018_semra_all_traits.csv")
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
#install.packages("readxl")
library(tidyverse)
library(readxl)
ph_2018 <- read.csv("../data/phenotyping_2018_semra_all_traits.csv")
ph_2018 <- read.csv("data/phenotyping_2018_semra_all_traits.csv")
#View(ph_2018)
names(ph_2018)
ph_2018 %>%
mutate(pollinationtype = NA,
pollinationtype=ifelse(grepl("@",Genotype),"self",pollinationtype),
pollinationtype=ifelse(grepl("op",tolower(Genotype)),"open",pollinationtype),
Genotype=gsub("op","",tolower(Genotype)),
Genotype=gsub("@","",tolower(Genotype)),
Genotype = str_squish(Genotype)) %>%
arrange(Genotype) %>%
filter(pollinationtype == "open") %>%
rename(genotype = Genotype,
year = Year) -> ph_2018.b
ph_2018.b %>%
select(genotype, Average.cob.length, Replication, Row) %>%
rename(AverageCobLength = `Average.cob.length`) %>%
rename(row = `Row`)%>%
arrange(genotype) %>%
mutate(year = 2018) %>%
arrange(genotype) ->  cobl_2018
# group_by(genotype) %>%
# summarise(meanAvgCob2018 = mean(cobLength2018),
#           sdAvgCob2018 = sd(cobLength2018))
#View(ph_2018.b)
colnames(ph_2018.b)
ph_2018.b %>%
rename(row = Row)
colnames(ph_2018.b)[colnames(ph_2018.b) == "Row"] <- "row"
colnames(ph_2018.b)[colnames(ph_2018.b) == "genotype"] <- "Genotype"
head(ph_2018.b)
unique(ph_2018.b$Genotype)
ph_2018.b$meancw <- apply(ph_2018.b[, c("Cob.width.1", "Cob.width.2", "Cob.width.3", "Cob.width.4", "Cob.width.5", "Cob.width.6", "Cob.Width.7", "Cob.width.8")], 1, function(x){mean(x, na.rm=TRUE)})
ph_2018.b$Average.cob.width <- as.numeric(as.character(ph_2018.b$Average.cob.width))
plot(ph_2018.b$Average.cob.width, ph_2018.b$meancw)
idx <- which(round(ph_2018.b$Average.cob.width, 1) != round(ph_2018.b$meancw, 1))
cw[idx,]
#meta data for 2018
fb <- read.csv("cache/fb2018_meta.csv")
fb$quadrant <- floor(fb$row/1000)
#View(fb)
#cw$row <- gsub("-.*", "", cw$Line.number)
#fb1 <- subset(fb, row %% 2 == 1)
#ph_2018.b$Row <- gsub("-.*", "", cw$Line.number)
fb1 <- subset(fb, row %% 2 == 1)
## remove duplicated rows
idx <- duplicated(ph_2018.b$row)
sub1 <- subset(ph_2018.b, row %in% ph_2018.b[idx,]$row)
cw1 <- subset(ph_2018.b, !(row %in% ph_2018.b[idx,]$row))
fb1cw <- merge(fb1, cw1[, c("row", "meancw")], by="row", all.x=TRUE)
#View(fb1cw)
colnames(fb1cw)[colnames(fb1cw) == "pedigree"] <- "Pedigree"
colnames(fb1cw)[colnames(fb1cw) == "genotype"] <- "Genotype"
write.table(fb1cw[, -6], "cache/pheno2018_cobwidth.csv", sep=",", row.names = FALSE, quote=FALSE)
write.table(subset(fb1cw[, -6], nitrogen %in% "+N"), "cache/pheno2018_cobwidth_withN.csv", sep=",", row.names = FALSE, quote=FALSE)
write.table(subset(fb1cw[, -6], nitrogen %in% "-N"), "cache/pheno2018_cobwidth_noN.csv", sep=",", row.names = FALSE, quote=FALSE)
# how many of the non-check plots have no data
nonch <- subset(fb1cw, !(Genotype %in% "Check"))
sum(is.na(nonch$meancw))
nonch_data <- subset(nonch, !is.na(meancw))
t.test(subset(fb1cw, quadrant %in% "1")$meancw, subset(fb1cw, quadrant %in% "2")$meancw, na.rm=TRUE)
t.test(subset(fb1cw, quadrant %in% "3")$meancw, subset(fb1cw, quadrant %in% "4")$meancw, na.rm=TRUE)
library(ggplot2)
fsize=16
p1 <- ggplot(fb1cw, aes(x=meancw, color=as.factor(quadrant))) +
facet_grid(block ~ nitrogen) +
geom_histogram(bins=30) +
#labs(y=NULL, fill="Traits") + theme_bw() +
theme(#axis.text.x=element_blank(), axis.ticks.x=element_blank(),
axis.text=element_text(size=12),
axis.title=element_text(size=fsize, face="bold"),
legend.title = element_text(size=fsize, face="bold"),
legend.text = element_text(size=fsize),
strip.text = element_text(size = fsize, face = "bold")) +
xlab("Cob Width") +
ylab("Frequency")
p1
fb <- read.csv("cache/fb2019_meta_replaced_check.csv")
fb$quadrant <- floor(fb$row/1000)
#View(fb)
cw <- read.csv("data/phenotyping_2019_semra_cobwidth_raw.csv")
table(cw$Number.of.ears)
cw$meancw <- apply(cw[, c("Cob.width.1", "Cob.width.2", "Cob.width.3", "Cob.width.4", "Cob.width.5", "Cob.width.6")], 1, function(x){mean(x, na.rm=TRUE)})
#View(cw$meancw)
#cw$meancw <- apply(cw[, 3:8], 1, function(x){mean(x, na.rm=TRUE)})
#cw$Average.cob.width <- as.numeric(as.character(cw$Average.cob.width))
#plot(cw$Average.cob.width, cw$meancw)
#idx <- which(round(cw$Average.cob.widtht, 1) != round(cw$meancw, 1))
#cw[idx,]
cw$row <- gsub("-.*", "", cw$Line.number)
View(cw)
cw$row <- gsub("-.*", "", cw$Row.number)
cw$row <- gsub("-.*", "", cw$Row.number)
fb1 <- subset(fb, row %% 2 == 1)
#View(fb1)
## remove duplicated rows
idx <- duplicated(cw$row)
sub1 <- subset(cw, row %in% cw[idx,]$row)
cw1 <- subset(cw, !(row %in% cw[idx,]$row))
dim(cw1)
#View(cw1)
fb1cw <- merge(fb1, cw1[, c("row", "meancw")], by="row", all.x=TRUE)
#View(fb1cw)
# Quality checking
# how many of the non-check plots have no data
nonch <- subset(fb1cw, !(Genotype %in% "Check"))
sum(is.na(nonch$meancw))
nonch_data <- subset(nonch, !is.na(meancw))
t.test(subset(fb1cw, quadrant %in% "1")$meancw, subset(fb1cw, quadrant %in% "2")$meancw, na.rm=TRUE)
t.test(subset(fb1cw, quadrant %in% "3")$meancw, subset(fb1cw, quadrant %in% "4")$meancw, na.rm=TRUE)
write.table(fb1cw[, -16], "cache/pheno2019_cobwidth.csv", sep=",", row.names = FALSE, quote=FALSE)
write.table(subset(fb1cw[, -16], nitrogen %in% "+N"), "cache/pheno2019_cobwidth_withN.csv", sep=",", row.names = FALSE, quote=FALSE)
write.table(subset(fb1cw[, -16], nitrogen %in% "-N"), "cache/pheno2019_cobwidth_noN.csv", sep=",", row.names = FALSE, quote=FALSE)
# how many of the non-check plots have no data
nonch <- subset(fb1cw, !(Genotype %in% "Check"))
sum(is.na(nonch$meancw))
nonch_data <- subset(nonch, !is.na(meancw))
t.test(subset(fb1cw, quadrant %in% "1")$meancw, subset(fb1cw, quadrant %in% "2")$meancw, na.rm=TRUE)
t.test(subset(fb1cw, quadrant %in% "3")$meancw, subset(fb1cw, quadrant %in% "4")$meancw, na.rm=TRUE)
library(ggplot2)
fsize=16
p2 <- ggplot(fb1cw, aes(x=meancw, color=as.factor(quadrant))) +
facet_grid(block ~ nitrogen) +
geom_histogram(bins=30) +
#labs(y=NULL, fill="Traits") + theme_bw() +
theme(#axis.text.x=element_blank(), axis.ticks.x=element_blank(),
axis.text=element_text(size=12),
axis.title=element_text(size=fsize, face="bold"),
legend.title = element_text(size=fsize, face="bold"),
legend.text = element_text(size=fsize),
strip.text = element_text(size = fsize, face = "bold")) +
xlab("Cob Width") +
ylab("Frequency")
p2
### first, we need to organize both data set. (they need to have the same columns)
cobwidth_2019_N <- read.csv("cache/pheno2019_cobwidth_withN.csv")
cobwidth_2018_N <- read.csv("cache/pheno2018_cobwidth_withN.csv")
#View(cobwidth_2019)
#View(cobwidth_2018)
cobwidth_18_19_N <- rbind(cobwidth_2019_N, cobwidth_2018_N)
#View(cobwidth_18_19)
write.table(cobwidth_18_19_N, "cache/cobwidth_2018_2019_N.csv", sep=",", row.names = FALSE, quote=FALSE)
cobwidth_2018_noN <- read.csv ("cache/pheno2018_cobwidth_noN.csv")
cobwidth_2019_noN <- read.csv ("cache/pheno2019_cobwidth_noN.csv")
cobwidth_18_19_noN <- rbind (cobwidth_2018_noN, cobwidth_2019_noN)
write.table(cobwidth_18_19_noN, "cache/cobwidth_2018_2019_noN.csv", sep=",", row.names = FALSE, quote=FALSE)
#install.packages(devtools)
devtools::install_github("jyanglab/g3tools")
library(g3tools)
library(lme4)
#p1 <- read.csv("cache/pheno2019_cobwidth_withN.csv")
get_BLUP(data = cobwidth_18_19_N, model = meancw ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb)+ (1
| Genotype:year), which.factor = "Genotype",
outfile = "cache/GWAS_DATA/CobWidth_BLUP_2018_2019_withN_lme4.csv")
library(lme4)
#p1 <- read.csv("cache/pheno2019_cobwidth_withN.csv")
get_BLUP(data = cobwidth_18_19_N, model = meancw ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb)+ (1
| Genotype:year), which.factor = "Genotype",
outfile = "../cache/GWAS_DATA/CobWidth_BLUP_2018_2019_withN_lme4.csv")
### first, we need to organize both data set. (they need to have the same columns)
cobwidth_2019_N <- read.csv("cache/pheno2019_cobwidth_withN.csv")
cobwidth_2018_N <- read.csv("cache/pheno2018_cobwidth_withN.csv")
#View(cobwidth_2019)
#View(cobwidth_2018)
cobwidth_18_19_N <- rbind(cobwidth_2019_N, cobwidth_2018_N)
#View(cobwidth_18_19)
write.table(cobwidth_18_19_N, "cache/cobwidth_2018_2019_N.csv", sep=",", row.names = FALSE, quote=FALSE)
cobwidth_2018_noN <- read.csv ("cache/pheno2018_cobwidth_noN.csv")
cobwidth_2019_noN <- read.csv ("cache/pheno2019_cobwidth_noN.csv")
cobwidth_18_19_noN <- rbind (cobwidth_2018_noN, cobwidth_2019_noN)
write.table(cobwidth_18_19_noN, "cache/cobwidth_2018_2019_noN.csv", sep=",", row.names = FALSE, quote=FALSE)
#install.packages(devtools)
devtools::install_github("jyanglab/g3tools")
library(g3tools)
library(lme4)
get_BLUP(data = cobwidth_18_19_N, model = meancw ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb)+ (1
| Genotype:year), which.factor = "Genotype",
outfile = "cache/GWAS_DATA/CobWidth_BLUP_2018_2019_withN_lme4.csv")
get_BLUP(data = cobwidth_18_19_noN, model = meancw ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb) + (1
| Genotype:year), which.factor = "Genotype",
outfile = "cache/GWAS_DATA/CobWidth_BLUP_2018_2019_noN_lme4.csv")
