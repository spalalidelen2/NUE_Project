plot
library(tidyr)
library(ggplot2)
plot <- ggplot(data=s,aes(x=trait,y=Mean) +
plot <- plot + scale_x_discrete(labels=c("-N","+N")) + #x-labels
labs(title="Semra",
xlab="trait, c(kwN,kwnoN)",ylab="Mean") #title and axis labels
plot <- plot + theme(panel.grid.major = element_blank(),
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
library(tidyr)
library(ggplot2)
#setting names
names(nonit) <-c("Genotype","BLUP_noN")
names(nit) <- c("Genotype","BLUP_N")
#checking if data is read in correctly
head(nonit)
head(nit)
dim(nonit)
dim(nit)
#merging the two data sets. all=T means that we include the genotypes that only have 1 data point.
combined<- merge.data.frame(nonit,nit,by="Genotype",all=T)
View(combined)
combinedlong <- gather(combined,Nitrogen,BLUP,c("BLUP_noN","BLUP_N"),factor_key = T)
View(combinedlong)
s <- read.csv("data/blup_mean.csv")
summary(s)
library(ggplot2)
#s <- read.csv("cache/s_t37.csv")
s <- s[order(s$Mean, decreasing=FALSE),]
s$trait <- factor(s$trait, levels = s$trait)
plot <- ggplot(data=s,aes(x=trait,y=Mean)) +
geom_boxplot(outlier.colour="red",notch=T) #red color for outliers, notch=T just means there is a curve in the box plot. Change to notch=F to get a simple box
#s <- read.csv("cache/s_t37.csv")
s <- s[order(s$Mean, decreasing=FALSE),]
s$trait <- factor(s$trait, levels = s$trait)
p <- ggplot(s, aes(x=Mean, y=trait)) +
geom_point() +
xlab("S") +
ylab("") +
ggtitle("") +
theme_classic() +
labs(color = "") +
scale_y_continuous(limits = c(-1, 3)) +
geom_vline(xintercept=0, linetype="dashed", color = "red") +
theme(plot.title = element_text(size=20, face = "bold"),
axis.text=element_text(size=16, face="bold"),
strip.text.x = element_text(size = 16, face = "bold"),
axis.title=element_text(size=18, face="bold"),
#axis.text.x = element_text(angle = 20, hjust=0.6),
legend.position = c(0.8, 0.95),
#axis.text.x = element_text(angle = 20, hjust=0.6),
legend.title = element_text(size=18, face="bold"),
legend.text = element_text(size=18))
p + geom_vline(xintercept = 0)
#all_blup_data <- read.csv("cache/BLUP_RESULTS/all_blup_data.csv")
#View(all_blup_data)
#mean(all_blup_data$cwdnoN)
#sd(all_blup_data$cwdnoN)
s <- read.csv("data/blup_mean.csv")
summary(s)
library(ggplot2)
#s <- read.csv("cache/s_t37.csv")
s <- s[order(s$Mean, decreasing=FALSE),]
s$trait <- factor(s$trait, levels = s$trait)
p <- ggplot(s, aes(x=Mean, y=trait)) +
geom_point() +
xlab("S") +
ylab("") +
ggtitle("") +
theme_classic() +
labs(color = "") +
#scale_y_continuous(limits = c(-1, 3)) +
#geom_vline(xintercept=0, linetype="dashed", color = "red") +
theme(plot.title = element_text(size=20, face = "bold"),
axis.text=element_text(size=16, face="bold"),
strip.text.x = element_text(size = 16, face = "bold"),
axis.title=element_text(size=18, face="bold"),
#axis.text.x = element_text(angle = 20, hjust=0.6),
legend.position = c(0.8, 0.95),
#axis.text.x = element_text(angle = 20, hjust=0.6),
legend.title = element_text(size=18, face="bold"),
legend.text = element_text(size=18))
p + geom_vline(xintercept = 0)
#all_blup_data <- read.csv("cache/BLUP_RESULTS/all_blup_data.csv")
#View(all_blup_data)
#mean(all_blup_data$cwdnoN)
#sd(all_blup_data$cwdnoN)
s <- read.csv("data/blup_mean.csv")
summary(s)
library(ggplot2)
#s <- read.csv("cache/s_t37.csv")
s <- s[order(s$Mean, decreasing=FALSE),]
s$trait <- factor(s$trait, levels = s$trait)
p <- ggplot(s, aes(x=Mean, y=trait)) +
geom_point() +
xlab("Blup") +
ylab("") +
ggtitle("") +
theme_classic() +
labs(color = "") +
#scale_y_continuous(limits = c(-1, 3)) +
#geom_vline(xintercept=0, linetype="dashed", color = "red") +
theme(plot.title = element_text(size=20, face = "bold"),
axis.text=element_text(size=16, face="bold"),
strip.text.x = element_text(size = 16, face = "bold"),
axis.title=element_text(size=18, face="bold"),
#axis.text.x = element_text(angle = 20, hjust=0.6),
legend.position = c(0.8, 0.95),
#axis.text.x = element_text(angle = 20, hjust=0.6),
legend.title = element_text(size=18, face="bold"),
legend.text = element_text(size=18))
p + geom_vline(xintercept = 0)
plot <- ggplot(data=s,aes(x=Mean,y=trait)) +
geom_boxplot(outlier.colour="red",notch=T) #red color for outliers, notch=T just means there is a curve in the box plot. Change to notch=F to get a simple box
plot <- plot + scale_x_discrete(labels=c("-N","+N")) + #x-labels
labs(title="20 Kernel Weight BLUP Boxplots",
xlab="Nitrogen Application",ylab="BLUP") #title and axis labels
plot <- plot + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
#legend.text = element_text(size=13,face="bold"), #for legends
#legend.title = element_text(size=13, face="bold"), #for legends
axis.title.x = element_text(size=18,face="bold"), #format for x-axis
axis.title.y = element_text(size=18,face="bold"), #format for y-axis
axis.text = element_text(size=18), #format for title
plot.margin = unit(c(1,1,1,1),"cm"))#,
plot
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
library(readr)
kwh <- read.csv("cache/20_kernel_weight_2018_2019_noN.csv")
head(kwh)
class(kwh$Weight.of.20.seeds)
#View(kwh)
head(kwh)
tail(kwh)
dim(kwh)
devtools::install_github("jyanglab/g3tools")
library("g3tools")
ls(getNamespace("g3tools"), all.names=FALSE)
options(stringsAsFactors = FALSE)
library(devtools)
devtools::install_github("jyanglab/g3tools")
devtools::install_github("r-lib/devtools")
ls(getNamespace("g3tools"), all.names=FALSE)
pheno_noN <- kwh
library(lme4)
heritability <- get_BLUP(data = pheno_noN, model = Weight.of.20.seeds ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb) + (1
| Genotype:year), which.factor = "Genotype", outfile = "heritability.csv")
View(kwh)
heritability <- get_BLUP(data = pheno_noN, model = meancw ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb) + (1
| Genotype:year), which.factor = "Genotype", outfile = "heritability.csv")
summary(fit)
summary(heritability)
vg = 1.481290
ve = 2.838897
H2 = vg/(vg+ve/4) #Since I have 2 replications and 2 years. So, it is 2x2= 4
H2 #  0.7684206
H2 = vg/(vg+(ve/4)) #Since I have 2 replications and 2 years. So, it is 2x2= 4
H2 #  0.676075
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
View(kwh)
cwd <- read.csv("cache/cobwidth_2018_2019_N.csv")
head(cwd)
View(cwd)
class(cwd$meancw)
pheno_cwd <- cwd
#install.packages("Ime4")
library(lme4)
heritability <- get_BLUP(data = pheno_cwd, model = meancw ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb) + (1
| Genotype:year), which.factor = "Genotype", outfile = "heritability.csv")
summary(heritability)
vg = 5.12277
ve = 2.36305
H2 = vg/(vg+ve/4) #Since I have 2 replications and 2 years. So, it is 2x2= 4
H2 #  0.7684206
cwd_No <- read.csv("cache/cobwidth_2018_2019_noN.csv")
cwd_No <- read.csv("cache/cobwidth_2018_2019_noN.csv")
head(cwd_No)
View(cwd_No)
head(cwd_No)
tail(cwd_No)
dim(cwd_No)
pheno_noN <- cwd_No
heritability <- get_BLUP(data = pheno_noN, model = meancw ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb) + (1
| Genotype:year), which.factor = "Genotype", outfile = "heritability.csv")
summary(heritability)
vg = 4.2852
ve = 2.6153
H2 = vg/(vg+(ve/4)) #Since I have 2 replications and 2 years. So, it is 2x2= 4
H2 #  0.676075
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
library(readr)
cwd <- read.csv("cache/cob_weight_2018_2019_N.csv")
head(cwd)
class(cwd$meancw)
#View(cwd)
head(cwd)
tail(cwd)
dim(cwd)
class(cwd$Average.cob.weight)
pheno_cwd <- cwd
#install.packages("Ime4")
library(lme4)
heritability <- get_BLUP(data = pheno_cwd, model = meancw ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb) + (1
| Genotype:year), which.factor = "Genotype", outfile = "heritability.csv")
heritability <- get_BLUP(data = pheno_cwd, model = Average.cob.weight ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb) + (1
| Genotype:year), which.factor = "Genotype", outfile = "heritability.csv")
summary(heritability)
vg = 10.80654
ve = 24.51257
H2 = vg/(vg+ve/4) #Since I have 2 replications and 2 years. So, it is 2x2= 4
H2 #  0.8966029
library(readr)
cwd_No <- read.csv("cache/cob_weight_2018_2019_noN.csv")
head(cwd_No)
class(cwd_No$meancw)
View(cwd_No)
head(cwd_No)
tail(cwd_No)
dim(cwd_No)
library(readr)
cwd_No <- read.csv("cache/cob_weight_2018_2019_noN.csv")
head(cwd_No)
class(cwd_No$Average.cob.weight)
View(cwd_No)
head(cwd_No)
tail(cwd_No)
dim(cwd_No)
pheno_noN <- cwd_No
library(lme4)
heritability <- get_BLUP(data = pheno_noN, model = Average.cob.weight ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb) + (1
| Genotype:year), which.factor = "Genotype", outfile = "heritability.csv")
summary(heritability)
vg = 6.1909
ve = 24.8367
H2 = vg/(vg+(ve/4)) #Since I have 2 replications and 2 years. So, it is 2x2= 4
H2 #  0.8676206
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
library(readr)
cwd <- read.csv("cache/cob_length_2018_2019_N.csv")
head(cwd)
class(cwd$meancw)
#View(cwd)
head(cwd)
tail(cwd)
dim(cwd)
pheno_cwd <- cwd
#install.packages("Ime4")
library(lme4)
heritability <- get_BLUP(data = pheno_cwd, model = meancw ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb) + (1
| Genotype:year), which.factor = "Genotype", outfile = "heritability.csv")
summary(heritability)
vg = 2.23585
ve = 2.26501
H2 = vg/(vg+ve/4) #Since I have 2 replications and 2 years. So, it is 2x2= 4
H2 #  0.8966029
cwd_No <- read.csv("cache/cob_length_2018_2019_noN.csv")
library(readr)
cwd_No <- read.csv("cache/cob_length_2018_2019_noN.csv")
head(cwd_No)
class(cwd_No$meancw)
View(cwd_No)
head(cwd_No)
tail(cwd_No)
dim(cwd_No)
pheno_noN <- cwd_No
heritability <- get_BLUP(data = pheno_noN, model = meancw ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb) + (1
| Genotype:year), which.factor = "Genotype", outfile = "heritability.csv")
summary(heritability)
vg = 1.481290
ve = 2.838897
H2 = vg/(vg+(ve/4)) #Since I have 2 replications and 2 years. So, it is 2x2= 4
H2 #  0.8676206
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
library(readr)
kwh <- read.csv("cache/20_kernel_weight_2018_2019_N.csv")
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
library(readr)
kwh <- read.csv("cache/20_kernel_weight_2018_2019_N.csv")
library(readr)
kwh <- read.csv("cache/20_kernel_weight_2018_2019_N.csv")
kwh <- read.csv("../cache/20_kernel_weight_2018_2019_N.csv")
pheno <- kwh
install.packages("Ime4")
library(lme4)
heritability <- get_BLUP(data = pheno, model = Weight.of.20.seeds ~ (1 | Genotype) + (1 | year) + (1 | block) + (1 | sb) + (1 | spb) + (1
| Genotype:year), which.factor = "Genotype", outfile = "heritability.csv")
summary(fit)
summary(heritability)
nebraska_genotype <- read.csv("data/heritability_all.csv")
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
nebraska_genotype <- read.csv("data/heritability_all.csv")
nebraska_genotype <- read.csv("../data/heritability_all.csv")
p1n <- ggplot(nebraska_genotype, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=5) +
geom_smooth(method='loess') +
theme_bw() +
xlab("genotype") +
ylab("leaf count") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
library("ggplot")
install.packages("ggplot")
install.packages("ggplot2")
install.packages("ggplot2")
library("ggplot")
library("ggplot2")
nebraska_genotype <- read.csv("../data/heritability_all.csv")
p1n <- ggplot(nebraska_genotype, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=5) +
geom_smooth(method='loess') +
theme_bw() +
xlab("genotype") +
ylab("leaf count") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
install.packages("ggplot2")
library("ggplot2")
nebraska_genotype <- read.csv("../data/heritability_all.csv")
#View(nebraska_genotype)
p1n <- ggplot(nebraska_genotype, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=5) +
geom_smooth(method='loess') +
theme_bw() +
xlab("traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
install.packages("ggplot2")
#install.packages("ggplot2")
library("ggplot2")
nebraska_genotype <- read.csv("../data/heritability_all.csv")
#View(nebraska_genotype)
p1n <- ggplot(nebraska_genotype, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=5) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
ggplot(nebraska_genotype, aes(value, fill = Trait)) + geom_histogram(binwidth = 1) + ggtitle("Mo17- the number of leaves in different time points in Alabama") + labs(x = 'Traits', y = 'freq')
ggplot(nebraska_genotype, aes(heritability, fill = Trait)) + geom_histogram(binwidth = 1) + ggtitle("Mo17- the number of leaves in different time points in Alabama") + labs(x = 'Traits', y = 'freq')
ggplot(nebraska_genotype, aes(heritability, fill = Trait)) + geom_histogram(binwidth = 1) + ggtitle("Mo17- the number of leaves in different time points in Alabama") + labs(x = 'traits', y = 'freq')
nebraska_genotype <- read.csv("../data/heritability_all.csv")
View(nebraska_genotype)
ggplot(nebraska_genotype, aes(heritability, fill = traits)) + geom_histogram(binwidth = 1) + ggtitle("Mo17- the number of leaves in different time points in Alabama") + labs(x = 'traits', y = 'freq')
heritability <- read.csv("../data/heritability_all.csv")
#install.packages("ggplot2")
library("ggplot2")
heritability <- read.csv("../data/heritability_all.csv")
#View(heritability)
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=5) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
#install.packages("ggplot2")
library("ggplot2")
heritability <- read.csv("../data/heritability_all.csv")
#View(heritability)
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=5) +
geom_smooth(method='loess') +
theme_bw() +
xlab("") +
ylab("Heritability") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
#install.packages("ggplot2")
library("ggplot2")
heritability <- read.csv("../data/heritability_all.csv")
#View(heritability)
p1n <- ggplot(heritability, aes(x=, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=5) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
#install.packages("ggplot2")
library("ggplot2")
heritability <- read.csv("../data/heritability_all.csv")
#View(heritability)
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=5) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
#install.packages("ggplot2")
library("ggplot2")
heritability <- read.csv("../data/heritability_all.csv")
#View(heritability)
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=5) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
#install.packages("ggplot2")
library("ggplot2")
heritability <- read.csv("../data/heritability_all.csv")
#View(heritability)
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=8) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
#install.packages("ggplot2")
library("ggplot2")
heritability <- read.csv("../data/heritability_all.csv")
#View(heritability)
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=10) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
#install.packages("ggplot2")
library("ggplot2")
heritability <- read.csv("../data/heritability_all.csv")
#View(heritability)
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=9) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
heritability <- read.csv("../data/heritability_all.csv")
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=9) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
#install.packages("ggplot2")
library("ggplot2")
heritability <- read.csv("../data/heritability_all.csv")
#View(heritability)
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=5) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=12), axis.title=element_text(size=15) )
#########
p1n
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
library(readr)
cwd <- read.csv("../cache/cobwidth_2018_2019_N.csv")
head(cwd)
class(cwd$meancw)
#View(cwd)
head(cwd)
tail(cwd)
dim(cwd)
