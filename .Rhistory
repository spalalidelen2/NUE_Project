p1n
p1n + scale_color_manual(values = c("darkblue", "lightblue", "darkblue",
"lightblue", "darkblue", "lightblue", "darkblue", "lightblue"))
p1n + scale_color_manual(values = c("darkblue", "lightblue", "darkblue",
"lightblue", "darkblue", "lightblue", "darkblue", "lightblue")) +
scale_shape_manual(values = c(3, 3, 16, 16, 17, 17))
p1n + scale_shape_manual(values = c(3, 3, 16, 16, 17, 17))
p1n + scale_shape_manual(values = c(3, 23, 18, 16, 17, 17))
install.packages("ggpubr")
ggpubr::show_point_shapes()
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), shape = 18 by = "traits", head = TRUE)) +
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), shape = 18, by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
#########
p1n
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
heritability <- read.csv("../data/heritability_all.csv")
View(heritability)
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), shape = 18, by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
library("ggplot2")
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), shape = 18, by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
#########
p1n
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), shape = 18, by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
#geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
#########
p1n
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), shape = 18, size =12, by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
#geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
#########
p1n
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
scale_shape_manual(values = c(5, 16, 17)) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
#########
p1n
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
scale_shape_manual(values = c(3, 23, 18, 16, 17, 17)) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
#########
p1n
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
scale_shape_manual(values = c(3, 23, 18, 16, 17, 19, 20, 21 )) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
#########
p1n
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
scale_shape_manual(values = c(3, 23, 18, 16, 17, 19, 20, 21)) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
#########
p1n
p1n + scale_color_manual(values = c("darkblue", "lightblue", "darkblue",
p1n + scale_color_manual(values = c("darkblue", "lightblue", "darkblue",
"lightblue", "darkblue", "lightblue", "darkblue", "lightblue")) +
p1n + scale_shape_manual(values = c(3, 23, 18, 16, 17, 19, 20, 21))
p1n + scale_color_manual(values = c("darkblue", "lightblue", "darkblue",
p1n + scale_color_manual(values = c("darkblue", "lightblue", "darkblue",
"lightblue", "darkblue", "lightblue", "darkblue", "lightblue")) +
scale_shape_manual(values = c(3, 23, 18, 16, 17, 19, 20, 21))
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
#scale_shape_manual(values = c(3, 23, 18, 16, 17, 19, 20, 21)) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
p1n + scale_color_manual(values = c("darkblue", "lightblue", "darkblue",
"lightblue", "darkblue", "lightblue", "darkblue", "lightblue")) +
scale_shape_manual(values = c(3, 23, 18, 16, 17, 19, 20, 21))
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
#scale_shape_manual(values = c(3, 23, 18, 16, 17, 19, 20, 21)) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
#########
p1n <- p1n +expend_limits(x=0, y=0)
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
#scale_shape_manual(values = c(3, 23, 18, 16, 17, 19, 20, 21)) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) ) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0))
#########
p1n
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) ) +
scale_x_continuous(expand = c(0, 0), limits = c(0, NA)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, NA))
#########
p1n
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
#########
p1n + scale_x_continuous(expand = c(0, 0), limits = c(0, NA)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, NA))
#########
p1n + geom_point() + scale_x_continuous(expand = expansion(mult = c(0, 0))) + scale_y_continuous(expand = expansion(mult = c(0, 0)))
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17) )
p1n
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 15))
p1n
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17))
p1n
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1))
p1n
heritability <- read.csv("../data/heritability_all.csv")
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1))
p1n
#install.packages("ggplot2")
#install.packages("tidyverse")
library("ggplot2")
heritability <- read.csv("../data/heritability_all.csv")
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1)) ##force it to start zero
p1n
p1n + scale_color_manual(values = c("darkblue", "lightblue", "darkblue",
"lightblue", "darkblue", "lightblue", "darkblue", "lightblue")) +
scale_shape_manual(values = c(3, 23, 18, 16, 17, 19, 20, 21))
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
Vg= 1.481289
Vgxy= 1.216116
Vgxb= 0
Ny = 2
Nb = 2
NyxNb = 4
H2 = Vg/ ((Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
Ve= 2.838897
H2 = Vg/ ((Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2 #  0.6760749
Vg= 5.380e-01
Ve= 6.486e-01
Vgxy= 7.265e-02
Vgxb= 2.292e-14
Ny = 2
Nb = 2
NyxNb = 4
H2 = Vg/ ((Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
Vg= 4.99488
Ve= 2.15008
Vgxy= 1.39980
Vgxb= 0.24547
Ny = 2
Nb = 2
NyxNb = 4
H2 = Vg/ ((Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2 # 2.710669
Vg= 4.095e+00
Ve= 2.290e+00
Vgxy= 1.907e+00
Vgxb= 3.668e-01
Ny = 2
Nb = 2
NyxNb = 4
H2 = Vg/ ((Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2 # 3.672287
Vg= 5.380e-01
Ve= 6.486e-01
Vgxy= 7.265e-02
Vgxb= 2.292e-14
Ny = 2
Nb = 2
NyxNb = 4
H2 = Vg/ (Vg + (Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2 # 2.710669
Vg= 1.481289
Vgxy= 1.216116
Vgxb= 0
Ny = 2
Nb = 2
NyxNb = 4
Ve= 2.838897
H2 = Vg/ (Vg + (Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2 # 1.124077
Vg= 4.99488
Ve= 2.15008
Vgxy= 1.39980
Vgxb= 0.24547
Ny = 2
Nb = 2
NyxNb = 4
H2 = Vg/ (Vg + (Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2 # 3.672287
Vg= 4.095e+00
Ve= 2.290e+00
Vgxy= 1.907e+00
Vgxb= 3.668e-01
Ny = 2
Nb = 2
NyxNb = 4
H2 = Vg/ (Vg + (Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2 # 2.395577
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
Vg= 1.081e+01
Ve= 2.451e+01
Vgxy= 6.369e+00
Vgxb= 3.900e-12
Ny = 2
Nb = 2
NyxNb = 4
H2 = Vg/ (Vg + (Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2 # 0.7054993
Vg= 6.191e+00
Ve= 2.484e+01
Vgxy= 8.519e+00
Vgxb= 5.732e-14
Ny = 2
Nb = 2
NyxNb = 4
H2 = Vg/ (Vg + (Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2 # 0.5372229
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
Vg= 2.20425
Ve= 2.20963
Vgxy= 0.93726
Vgxb= 0.06109
Ny = 2
Nb = 2
NyxNb = 4
H2 = Vg/ (Vg + (Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2 # 0.3715975
Vg= 1.481289
Ve= 2.838897
Vgxy= 1.216116
Vgxb= 0
H2 = Vg/ (Vg + (Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2 # 0.6770158
vg = 5.380e-01
ve = 6.486e-01
H2 = vg/(vg+ve/4) #Since I have 2 replications and 2 years. So, it is 2x2= 4
H2 #  0.7684068
heritability <- read.csv("../data/heritability_all.csv")
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1)) ##force it to start zero
#install.packages("ggplot2")
#install.packages("tidyverse")
library("ggplot2")
p1n <- ggplot(heritability, aes(x=traits, y=heritability, colour = factor(traits), by = "traits", head = TRUE)) +
#facet_grid(. ~ type) +
geom_point(size=12) +
geom_smooth(method='loess') +
theme_bw() +
xlab("Traits") +
ylab("Heritability") +
theme(axis.text=element_text(size=14), axis.title=element_text(size=17)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1)) ##force it to start zero
p1n
p1n
p1n + scale_color_manual(values = c("darkblue", "lightblue", "darkblue",
"lightblue", "darkblue", "lightblue", "darkblue", "lightblue")) +
scale_shape_manual(values = c(3, 23, 18, 16, 17, 19, 20, 21))
Vg= 1.481289
Ve= 2.838897
Vgxy= 1.216116
Vgxb= 0
Ny = 2
Nb = 2
NyxNb = 4
H2 = Vg/ (Vg + (Vgxy/Ny) + (Vgxb/Nb) + (Ve/NyxNb))
H2 # 0.5292073
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
df <- read.csv ("../data/Appendix_2a_Top5_18Sept2013.csv")
head(df)
class(df$Latitude)
View(df)
df$Latitude <- as.numeric(as.character(df$Latitude))
range(df$Latitude, na.rm = T)
df$Longitude <- as.numeric(as.character(df$Longitude))
range(df$Longitude, na.rm = T)
#install.packages("ggmap")
library(ggmap)
##lowerleftlon, lowerleftlat, upperrightlon, upperrightlat
myloc <- c(-124, 25, -68, 50)
mymap <- get_map(location=myloc, source="stamen", crop=FALSE, color="bw")
ggmap(mymap) +
geom_point(aes(x = Longitude, y = Latitude), data = df,
alpha = .9, size = 1, col="red")
library(plyr)
c <- ddply(df, .(StateID), nrow)
head(c)
c <- subset(c, StateID != "")
df2 <- merge(c, df[, c("StateID",  "Latitude", "Longitude")], by="StateID")
df2 <- df2[!duplicated(df2$StateID), ]
mymap <- get_map(location=myloc, source="stamen", crop=FALSE, color="bw")
ggmap(mymap) +
geom_point(aes(x = Longitude, y = Latitude), data = df2,
alpha = .9, size = df2$V1/50, col="red")
install.packages("usmap")
library(usmap) #import the package
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
install.packages("usmap")
install.package("devtools")
devtools::install_github("pdil/usmap")
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
plot_usmap(regions = "states") +
labs(title = "U.S. States",
subtitle = "This is a blank map of the United States.") +
theme(panel.background=element_blank())
devtools::install_github("pdil/usmap")
getwd()
install.packages("usmap/home/rstudio-user/R")
devtools::install_github("pdil/usmap/home/rstudio-user/R")
install.packages("usmap")
library(ggplot2)
library(maps)
install.packages("maps")
install.packages("maps")
library(ggplot2)
library(maps)
library(mapdata)
install.packages("mapdata")
install.packages("mapdata")
library(mapdata)
usa <- map_data('usa')
library(tidyverse)
library(sf)
library(plotly)
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("sf")
install.packages("sf")
install.packages("plotly")
library(tidyverse)
library(sf)
library(plotly)
library(plotly)
states <- read_sf("resources/us_map/US-State-Boundaries-Census-2014.shp") %>%
st_zm() %>%
mutate(water_km2 = (AWATER / (1000*1000)) %>% round(2))
states <- read_sf("../data/Appendix_2a_Top5_18Sept2013.csv") %>%
st_zm() %>%
mutate(water_km2 = (AWATER / (1000*1000)) %>% round(2))
df <- read.csv ("../data/Appendix_2a_Top5_18Sept2013.csv")
df <- read.csv ("../data/Appendix_2a_Top5_18Sept2013.csv")
g <- ggplot(df) +
geom_sf(aes(fill=Top5_Cd)) +
scale_fill_distiller("water level", palette="Spectral") +
ggtitle("Water by State")
ggplotly(g)
g <- ggplot(df) +
geom_sf(aes(fill=Top5_Cd)) +
scale_fill_distiller("water level", palette="Spectral") +
ggtitle("Water by State")
ggplotly(g)
g <- ggplot(df) +
geom_sf(aes(fill=Top5_Cd)) +
scale_fill_distiller("water level", palette="StateID") +
ggtitle("Water by State")
ggplotly(g)
library(ggplot2)
library(tmap)
install.packages("tmap")
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
install.packages("tmap")
install.packages("tmaptools")
install.packages("sf")
install.packages("leaflet")
library("tmap")
library("tmaptools")
library("sf")
library("leaflet")
library("leaflet")
install.packages("leaflet")
library("leaflet")
library(leaflet)
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir=normalizePath('../../'))
cobwidth_2018_noN <- read.csv ("../cache/pheno2018_cobwidth_noN.csv")
cobwidth_2019_noN <- read.csv ("../cache/pheno2019_cobwidth_noN.csv")
View(cobwidth_2018_noN)
sn <- read.csv ("../cache/cobwidth_2018_2019_noN.csv")
View(sn)
